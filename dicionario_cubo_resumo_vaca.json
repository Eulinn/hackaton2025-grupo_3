{
    "tabela": "cubo_resumo_vaca",
    "descricao": "Cubo otimizado para consultas rápidas de dados individuais de vacas com campos calculados e classificações automáticas",
    "versao": "1.0",
    "criado_em": "2025-10-23",
    "tipo": "VIEW_OTIMIZADA",
    "total_registros": 47734,
    "diferencial": "View virtual baseada em vw_resumo_vaca com JOIN para incluir nome e campos calculados para análise individual de vacas",
    "estatisticas_gerais": {
        "vacas_elite": 6497,
        "vacas_boa_produtora": 18487,
        "vacas_producao_regular": 17643,
        "vacas_producao_baixa": 3995,
        "vacas_sem_producao": 1112,
        "producao_max_litros": 55628.02,
        "producao_media_litros": 12847.56,
        "max_partos_por_vaca": 8
    },
    "campos_principais": {
        "identificacao": {
            "codigo_bovino": {
                "tipo": "VARCHAR",
                "descricao": "Código único da vaca",
                "exemplo": "FSC33614",
                "uso": "Identificação primária para busca específica"
            },
            "nome_vaca": {
                "tipo": "VARCHAR",
                "descricao": "Nome legível da vaca (JOIN com tabela bovino)",
                "exemplo": "Vaca33614",
                "uso": "Apresentação em relatórios e busca por nome"
            }
        },
        "dados_producao": {
            "lactacoes_encerradas": {
                "tipo": "INTEGER",
                "descricao": "Número total de lactações finalizadas pela vaca",
                "exemplo": 1,
                "uso": "Avaliar histórico produtivo"
            },
            "producao_vitalicia_leite": {
                "tipo": "DECIMAL",
                "descricao": "Total de litros de leite produzidos durante toda vida produtiva",
                "exemplo": 9621.25,
                "uso": "Principal métrica de performance da vaca",
                "importancia": "CRITICA"
            },
            "producao_vitalicia_gordura": {
                "tipo": "DECIMAL",
                "descricao": "Total de kg de gordura produzidos durante vida produtiva",
                "exemplo": 325.12,
                "uso": "Avaliar qualidade e valor comercial do leite"
            },
            "producao_vitalicia_proteina": {
                "tipo": "DECIMAL",
                "descricao": "Total de kg de proteína produzidos durante vida produtiva",
                "exemplo": 289.62,
                "uso": "Avaliar valor nutricional e comercial"
            }
        },
        "historico_reprodutivo": {
            "numero_partos": {
                "tipo": "INTEGER",
                "descricao": "Total de partos realizados pela vaca",
                "exemplo": 2,
                "uso": "Avaliar fertilidade e capacidade reprodutiva"
            },
            "eficiencia_lactacional_pct": {
                "tipo": "DECIMAL",
                "descricao": "Percentual de lactações em relação ao número de partos",
                "exemplo": 50.0,
                "uso": "Medir eficiência reprodutiva (lactações/partos * 100)"
            }
        },
        "metricas_calculadas": {
            "producao_media_por_lactacao": {
                "tipo": "DECIMAL",
                "descricao": "Média de litros produzidos por lactação",
                "exemplo": 9621.25,
                "uso": "Avaliar produtividade por ciclo lactacional"
            },
            "percentual_gordura": {
                "tipo": "DECIMAL",
                "descricao": "Percentual de gordura no leite (gordura/leite * 100)",
                "exemplo": 3.38,
                "uso": "Avaliar qualidade e valor comercial do leite"
            },
            "percentual_proteina": {
                "tipo": "DECIMAL",
                "descricao": "Percentual de proteína no leite (proteína/leite * 100)",
                "exemplo": 3.01,
                "uso": "Avaliar valor nutricional e comercial"
            }
        }
    },
    "campos_calculados": {
        "classificacoes": {
            "categoria_producao_vitalicia": {
                "tipo": "VARCHAR",
                "descricao": "Classificação automática baseada na produção total de leite",
                "valores": [
                    "ALTA_PRODUCAO (≥15.000L)",
                    "BOA_PRODUCAO (≥10.000L)",
                    "PRODUCAO_REGULAR (≥5.000L)",
                    "PRODUCAO_BAIXA (>0L)",
                    "SEM_PRODUCAO (0L)"
                ],
                "uso": "Filtrar vacas por nível de produção vitalícia",
                "importancia": "ALTA"
            },
            "status_reprodutivo": {
                "tipo": "VARCHAR",
                "descricao": "Classificação baseada no número de partos realizados",
                "valores": [
                    "ALTA_FERTILIDADE (≥5 partos)",
                    "BOA_FERTILIDADE (≥3 partos)",
                    "FERTILIDADE_NORMAL (≥1 parto)",
                    "SEM_PARTOS (0 partos)"
                ],
                "uso": "Avaliar capacidade reprodutiva da vaca"
            },
            "classificacao_geral": {
                "tipo": "VARCHAR",
                "descricao": "Classificação combinada considerando produção e reprodução",
                "valores": [
                    "ELITE (>12.000L + ≥3 partos)",
                    "BOA_PRODUTORA (>8.000L + ≥2 partos)",
                    "PRODUTORA_REGULAR (>5.000L)",
                    "PRODUTORA_BAIXA (>0L)",
                    "SEM_PRODUCAO (0L)"
                ],
                "uso": "Classificação geral para seleção e descarte",
                "importancia": "CRITICA"
            }
        },
        "indicadores_boolean": {
            "alta_producao_vitalicia": {
                "tipo": "BOOLEAN",
                "descricao": "Indica se produção vitalícia > 10.000 litros",
                "uso": "Filtrar vacas de alta produção rapidamente"
            },
            "boa_fertilidade": {
                "tipo": "BOOLEAN",
                "descricao": "Indica se número de partos ≥ 3",
                "uso": "Identificar vacas com boa capacidade reprodutiva"
            },
            "multiplas_lactacoes": {
                "tipo": "BOOLEAN",
                "descricao": "Indica se lactações encerradas ≥ 2",
                "uso": "Identificar vacas com histórico produtivo consolidado"
            },
            "todas_gestacoes_lactaram": {
                "tipo": "BOOLEAN",
                "descricao": "Indica se lactações = partos (100% eficiência)",
                "uso": "Identificar vacas com máxima eficiência reprodutiva"
            }
        }
    },
    "queries_exemplo": {
        "consulta_vaca_individual": {
            "sql": "SELECT * FROM cubo_resumo_vaca WHERE codigo_bovino = 'FSC33614'",
            "descricao": "Buscar dados completos de uma vaca específica"
        },
        "vacas_alta_performance": {
            "sql": "SELECT nome_vaca, codigo_bovino, producao_vitalicia_leite, numero_partos FROM cubo_resumo_vaca WHERE alta_producao_vitalicia = true AND boa_fertilidade = true ORDER BY producao_vitalicia_leite DESC",
            "descricao": "Vacas de elite com alta produção e fertilidade"
        },
        "ranking_producao_vitalicia": {
            "sql": "SELECT nome_vaca, codigo_bovino, producao_vitalicia_leite, classificacao_geral FROM cubo_resumo_vaca WHERE producao_vitalicia_leite > 0 ORDER BY producao_vitalicia_leite DESC LIMIT 10",
            "descricao": "Top 10 vacas por produção vitalícia"
        },
        "estatisticas_por_categoria": {
            "sql": "SELECT classificacao_geral, COUNT(*) as total_vacas, ROUND(AVG(producao_vitalicia_leite), 2) as media_producao FROM cubo_resumo_vaca WHERE producao_vitalicia_leite > 0 GROUP BY classificacao_geral ORDER BY media_producao DESC",
            "descricao": "Estatísticas de produção por classificação geral"
        },
        "vacas_eficiencia_maxima": {
            "sql": "SELECT * FROM cubo_resumo_vaca WHERE todas_gestacoes_lactaram = true AND multiplas_lactacoes = true",
            "descricao": "Vacas com 100% de eficiência lactacional"
        },
        "analise_qualidade_leite": {
            "sql": "SELECT nome_vaca, producao_vitalicia_leite, percentual_gordura, percentual_proteina FROM cubo_resumo_vaca WHERE percentual_gordura > 3.5 AND percentual_proteina > 3.2 ORDER BY producao_vitalicia_leite DESC",
            "descricao": "Vacas com leite de alta qualidade (gordura e proteína)"
        },
        "vacas_por_status_reprodutivo": {
            "sql": "SELECT status_reprodutivo, COUNT(*) as total, ROUND(AVG(producao_vitalicia_leite), 2) as media_producao FROM cubo_resumo_vaca GROUP BY status_reprodutivo ORDER BY media_producao DESC",
            "descricao": "Análise de produção por status reprodutivo"
        },
        "busca_por_nome": {
            "sql": "SELECT * FROM cubo_resumo_vaca WHERE nome_vaca = 'Vaca33614'",
            "descricao": "Buscar vaca pelo nome (além do código)"
        }
    },
    "dicas_uso": [
        "Use indicadores booleanos para filtros rápidos de performance",
        "classificacao_geral combina produção e reprodução para análise completa",
        "eficiencia_lactacional_pct identifica problemas reprodutivos",
        "percentual_gordura e percentual_proteina avaliam qualidade do leite",
        "Combine múltiplos critérios para seleção precisa de animais",
        "producao_media_por_lactacao normaliza a produção por ciclo",
        "Use categoria_producao_vitalicia para classificação rápida",
        "todas_gestacoes_lactaram identifica vacas de máxima eficiência"
    ],
    "casos_uso_comuns": {
        "selecao_descarte": "Filtrar por classificacao_geral = 'PRODUTORA_BAIXA' OR categoria_producao_vitalicia = 'SEM_PRODUCAO'",
        "vacas_elite": "Usar classificacao_geral = 'ELITE' AND alta_producao_vitalicia = true",
        "problemas_reprodutivos": "Filtrar por eficiencia_lactacional_pct < 80 AND numero_partos > 1",
        "qualidade_premium": "Usar percentual_gordura > 3.5 AND percentual_proteina > 3.2",
        "analise_longevidade": "Filtrar por multiplas_lactacoes = true AND producao_vitalicia_leite > 15000",
        "benchmarking": "Usar producao_media_por_lactacao para comparar eficiência por ciclo"
    },
    "vantagens_cubo": [
        "Consulta única inclui nome + código automaticamente",
        "Campos pré-calculados evitam cálculos repetitivos",
        "Classificações automáticas facilitam análises",
        "Indicadores booleanos aceleram filtros",
        "View virtual - sempre atualizada, sem espaço adicional",
        "Baseado em vw_resumo_vaca - dados consolidados e confiáveis",
        "Otimizado para análises individuais de vacas",
        "Suporte a busca por nome ou código"
    ],
    "limitacoes": [
        "Dados dependem da qualidade da vw_resumo_vaca base",
        "Não inclui dados de lactações em andamento",
        "Classificações são fixas - não personalizáveis",
        "Performance pode ser afetada em consultas muito grandes",
        "Percentuais de componentes assumem proporções típicas"
    ],
    "integracoes": {
        "fonte_principal": "vw_resumo_vaca (dados de produção e reprodução)",
        "fonte_secundaria": "bovino (nomes das vacas)",
        "relacionamentos": "JOIN por codigo_bovino = bovino.codigo",
        "atualizacao": "Automática via view - reflete mudanças nas fontes",
        "compatibilidade": "Integra com cubo_producao_touro_filhas para análises genéticas"
    },
    "exemplos_analise": {
        "gestao_rebanho": {
            "descricao": "Identificar vacas para descarte ou seleção",
            "query": "SELECT nome_vaca, classificacao_geral, producao_vitalicia_leite, numero_partos FROM cubo_resumo_vaca WHERE classificacao_geral IN ('PRODUTORA_BAIXA', 'SEM_PRODUCAO')"
        },
        "benchmarking_producao": {
            "descricao": "Comparar produção média por lactação",
            "query": "SELECT AVG(producao_media_por_lactacao) FROM cubo_resumo_vaca WHERE multiplas_lactacoes = true"
        },
        "analise_eficiencia": {
            "descricao": "Identificar problemas de eficiência reprodutiva",
            "query": "SELECT nome_vaca, numero_partos, lactacoes_encerradas, eficiencia_lactacional_pct FROM cubo_resumo_vaca WHERE eficiencia_lactacional_pct < 100 AND numero_partos > 1"
        }
    }
}
